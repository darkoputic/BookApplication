{"ast":null,"code":"import _classCallCheck from \"/Users/darkoputic/Projects/Practice/Angular/StoreApplication/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport { MatDialog } from '@angular/material/dialog';\nimport { Router } from '@angular/router';\nimport { Actions, ofType, createEffect } from '@ngrx/effects';\nimport { of } from 'rxjs';\nimport { catchError, exhaustMap, map, tap } from 'rxjs/operators';\nimport { LoginPageActions, AuthActions, AuthApiActions } from './../actions';\nimport { LogoutConfirmationDialogComponent } from '../components';\nimport { AuthService } from '../services';\nimport { UserActions } from '../../core/actions';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ngrx/effects\";\nimport * as i2 from \"../services\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/material/dialog\";\nexport var AuthEffects = /*#__PURE__*/(function () {\n  var AuthEffects = function AuthEffects(actions$, authService, router, dialog) {\n    var _this = this;\n\n    _classCallCheck(this, AuthEffects);\n\n    this.actions$ = actions$;\n    this.authService = authService;\n    this.router = router;\n    this.dialog = dialog;\n    this.login$ = createEffect(function () {\n      return _this.actions$.pipe(ofType(LoginPageActions.login), map(function (action) {\n        return action.credentials;\n      }), exhaustMap(function (auth) {\n        return _this.authService.login(auth).pipe(map(function (user) {\n          return AuthApiActions.loginSuccess({\n            user: user\n          });\n        }), catchError(function (error) {\n          return of(AuthApiActions.loginFailure({\n            error: error\n          }));\n        }));\n      }));\n    });\n    this.loginSuccess$ = createEffect(function () {\n      return _this.actions$.pipe(ofType(AuthApiActions.loginSuccess), tap(function () {\n        return _this.router.navigate(['/']);\n      }));\n    }, {\n      dispatch: false\n    });\n    this.loginRedirect$ = createEffect(function () {\n      return _this.actions$.pipe(ofType(AuthApiActions.loginRedirect, AuthActions.logout), tap(function (authed) {\n        _this.router.navigate(['/login']);\n      }));\n    }, {\n      dispatch: false\n    });\n    this.logoutConfirmation$ = createEffect(function () {\n      return _this.actions$.pipe(ofType(AuthActions.logoutConfirmation), exhaustMap(function () {\n        var dialogRef = _this.dialog.open(LogoutConfirmationDialogComponent);\n\n        return dialogRef.afterClosed();\n      }), map(function (result) {\n        return result ? AuthActions.logout() : AuthActions.logoutConfirmationDismiss();\n      }));\n    });\n    this.logoutIdleUser$ = createEffect(function () {\n      return _this.actions$.pipe(ofType(UserActions.idleTimeout), map(function () {\n        return AuthActions.logout();\n      }));\n    });\n  };\n\n  AuthEffects.ɵfac = function AuthEffects_Factory(t) {\n    return new (t || AuthEffects)(i0.ɵɵinject(i1.Actions), i0.ɵɵinject(i2.AuthService), i0.ɵɵinject(i3.Router), i0.ɵɵinject(i4.MatDialog));\n  };\n\n  AuthEffects.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: AuthEffects,\n    factory: AuthEffects.ɵfac\n  });\n  return AuthEffects;\n})();","map":null,"metadata":{},"sourceType":"module"}